:root {
  --sky:#cfefff; --sea:#78c9ff; --sand:#fffae1; --ink:#2b2b2b;
  --red:#ff5468; --green:#2ecc71; --black:#333; --blue:#46a2ff;
}

* { box-sizing: border-box }

body {
  margin: 0;
  font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, "PingFang SC","Microsoft Yahei", sans-serif;
  background: linear-gradient(var(--sky) 0 35%, var(--sea) 35% 45%, var(--sand) 45%);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Header HUD */
header {
  width: 100%; max-width: 1100px;
  margin: 12px 0 8px; padding: 10px 14px;
  background: #ffffffcc;
  border: 3px solid #00000010;
  border-radius: 18px;
  display: flex; align-items: center; justify-content: space-between; gap: 10px;
  box-shadow: 0 8px 18px rgba(0,0,0,.08);
}

h1 { margin: 0; font-size: 20px }

#hud { display:flex; gap:14px; align-items:center; font-weight:900 }
.chip {
  background:#00000010; border:2px solid #00000020;
  padding:4px 10px; border-radius:999px
}

#reset {
  background:var(--blue); color:#fff; border:3px solid #00000025;
  border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer;
  box-shadow:0 4px 0 #1b6ac0; transition:transform .08s;
}
#reset:active { transform: translateY(1px) }

/* Layout: left panel character / right panel bins */
.stage {
  width:100%; max-width:1100px; display:grid; gap:14px; grid-template-columns: 1fr 1.2fr;
  padding:8px 0 22px;
}
.left, .right {
  background:#fffdf7; border-radius:18px; padding:20px; position:relative;
  box-shadow:0 10px 24px rgba(0,0,0,.10);
  border:3px solid #00000010;
  min-height:700px;
}

/* Character block (base) */
.character {
  position:relative; display:flex; align-items:flex-end; justify-content:center;
  height:100%;
  /* 原本是渐变背景：background:linear-gradient(#fffdf7, #fff5d4); 由下面的 .left.character 覆盖 */
  border-radius:14px;
}
.character svg { width:60%; max-width:370px; filter: drop-shadow(0 6px 8px rgba(0,0,0,.12)); }
.hint {
  position:absolute; top:10px; right:10px;
  background:#fff; border:3px solid #00000025;
  border-radius:12px; padding:6px 10px; font-size:13px; font-weight:700;
}

/* ✅ 左侧容器样式优化：白底、浅灰边框、圆角与阴影；并让内容垂直水平居中 */
.left.character {
  background: #ffffff;                 /* 白底更干净 */
  border: 2px solid #e0e0e0;           /* 浅灰边框 */
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.10);
  display: flex;
  justify-content: center;             /* 水平居中 */
  align-items: center;                 /* 垂直居中 */
}

/* ✅ 场景容器与图片：始终居中且自适应 */
.scene-host {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;                        /* 占满左侧容器高度，以便垂直居中 */
  text-align: center;
}
.scene-host img {
  max-width: 100%;
  height: auto;
  display: block;
  border-radius: 12px;                 /* 图片也做圆角，和容器风格统一 */
}

/* Comic bubble */
.bubble {
  position:absolute; left:52%; top:8%;
  background:#fff; border:4px solid var(--ink); border-radius:16px; padding:10px 14px;
  font-weight:900; font-size:16px;
  transform-origin:left top; transform:scale(0);
  filter: drop-shadow(0 6px 0 rgba(0,0,0,.15));
}
.bubble::after {
  content:""; position:absolute; left:-18px; top:24px; width:0; height:0;
  border:12px solid transparent; border-right-color:var(--ink);
}
.bubble::before {
  content:""; position:absolute; left:-14px; top:26px; width:0; height:0;
  border:10px solid transparent; border-right-color:#fff; z-index:1;
}
.bubble.good { background:#eafff0; border-color:#0b7a33 }
.bubble.good::after { border-right-color:#0b7a33 }
.bubble.bad { background:#ffe8ec; border-color:#c2183b }
.bubble.bad::after { border-right-color:#c2183b }
.bubble.show { animation:pop .28s ease-out forwards }
@keyframes pop { from{transform:scale(0)} to{transform:scale(1)} }

/* Tray area */
.titlebar { display:flex; align-items:center; gap:8px; margin-bottom:8px; font-weight:900; }
.pill { background:#00000010; border:2px solid #00000020; padding:2px 8px; border-radius:999px; font-size:12px; }

.tray {
  background:#ffffffea; border:3px dashed #00000020; border-radius:12px; padding:10px;
  display:flex; flex-wrap:wrap; gap:10px; min-height:320px; margin-bottom:20px;
  overflow-y:auto;
}
.card {
  width:84px; aspect-ratio:1; background:#fff; border:3px solid #00000025; border-radius:14px;
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
  cursor:grab; user-select:none;
  box-shadow:4px 4px 0 #00000020; transition:transform .08s;
}
.card:active { transform:translateY(1px) scale(.98) }
.emoji { font-size:34px }
.label { font-size:12px; font-weight:800; text-align:center }

/* Bins */
.bins {
  position:relative; display:grid; grid-template-columns:repeat(4,1fr);
  gap:18px; margin-top:22px;
}
.bin {
  --bin-color:#46a2ff;
  background:#fff; border-radius:18px; border:4px solid rgba(0,0,0,.15);
  box-shadow:0 8px 0 rgba(0,0,0,.15);
  padding:12px 10px 16px; min-height:200px;
  display:flex; flex-direction:column; align-items:center; justify-content:flex-end;
  position:relative; transition:transform .12s;
}
.bin:hover { transform:translateY(-2px) }
.bin.hot { transform:translateY(-4px) }
.bin.shake { animation:shake .25s }
@keyframes shake { 25%{transform:translateX(-2px)} 50%{transform:translateX(2px)} 75%{transform:translateX(-2px)} }

.bin .can {
  width:90%; height:140px; margin-bottom:10px;
  display:flex; align-items:center; justify-content:center;
  pointer-events:none;
}
.bin .can.svg .trash {
  width:100%; height:100%;
  color: var(--bin-color);
  filter: drop-shadow(0 2px 0 rgba(0,0,0,.25));
}
.bin .label {
  font-weight:1000; text-align:center; color:#fff;
  text-shadow:1px 2px 0 rgba(0,0,0,.35);
  background:var(--bin-color);
  padding:6px 8px; border-radius:12px; width:92%;
}

/* Bin color mapping */
.bin[data-type="paper"]   { --bin-color:var(--red);  }
.bin[data-type="mpg"]     { --bin-color:var(--green);}
.bin[data-type="compost"] { --bin-color:var(--black);}
.bin[data-type="other"]   { --bin-color:var(--blue); }

/* Overlay panels */
.overlay {
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:linear-gradient(135deg, rgba(255,255,255,.98), rgba(200,230,255,.98));
  z-index:10; transition:opacity .2s;
}
.overlay.hide { opacity:0; pointer-events:none }
.panel {
  width:min(560px,90vw); background:#fff; border:4px solid #000; border-radius:18px; padding:18px;
  text-align:center; box-shadow:12px 12px 0 #00000020;
}
.panel h2 { margin:8px 0 12px }
.btn {
  background:#12b886; color:#fff; border:4px solid #0a7a5e; border-radius:14px;
  padding:10px 16px; font-weight:900; cursor:pointer;
  display:inline-flex; gap:8px; align-items:center;
  box-shadow:0 6px 0 #0a7a5e; transition:transform .08s;
}
.btn:active { transform:translateY(1px) }
.medal { font-size:48px; filter: drop-shadow(0 4px 0 rgba(0,0,0,.15)); }
.summary { font-weight:900; margin:8px 0 14px }

/* 悬浮音乐按钮（覆盖 overlay） */
.music-fab{
  position: fixed;
  top: 14px;
  right: 120px;              /* 可按需要调整，避免挡到 Restart */
  z-index: 1000;             /* 比 overlay 的 10 高很多 */
  background:#475569;        /* 关：灰色 */
  border-color:#1f2937;
  box-shadow:0 6px 0 #1f2937;
  font-weight:900;
  padding:8px 14px;
}

.music-fab.music-on{
  background:#10b981;        /* 开：绿色 */
  border-color:#0b7a5e;
  box-shadow:0 6px 0 #0b7a5e;
}
